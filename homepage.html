<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">

    <title>Homepage</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

    <link href="css/full-slider.css" rel="stylesheet">

            <!-- Script -->

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
        <script type="text/javascript" src="http://oauth.googlecode.com/svn/code/javascript/oauth.js"></script>
        <script type="text/javascript" src="http://oauth.googlecode.com/svn/code/javascript/sha1.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Start Bootstrap</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="#">About</a>
                    </li>
                    <li>
                        <a href="#">Services</a>
                    </li>
                    <li>
                        <a href="#">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Full Page Image Background Carousel Header -->
    <header id="myCarousel" class="carousel slide">

    <div class="form-group">    
        <div class="container">
            <div class="row">
            <div class="col-md-5">
                <input id="musicGenre" type="text" class="form-control input-lg" placeholder="Music genre...">  
            </div>
            <div class="col-md-5">
                <input id="city" type="text" class="form-control input-lg" placeholder="City...">   
            </div>
            <div class="col-md-2">
                <a class="btn btn-lg btn-success" href="#searchResults" role="button">GO</a>
            </div>
            </div>
        </div>
    </div>

        <!-- Wrapper for Slides -->
        <div class="carousel-inner">
            <div class="item active">
                <!-- http://vignette1.wikia.nocookie.net/tanz/images/2/29/34686042.jpg/revision/latest?cb=20140706161016&path-prefix=de 

                http://thyblackman.com/wp-content/uploads/2015/08/hiphop-2015.jpg

                http://www.hiphop-album-debate.com/wp-content/uploads/2015/09/I-love-hip-hop.jpg

                http://cdn.straightfromthea.com/wp-content/uploads/2011/12/Love-Hip-Hop-e1323735371356.jpg

                http://img15.deviantart.net/62f5/i/2009/104/d/8/biggie_hip_hop_painting_by_kyle_lambert.jpg
                -->
                <div class="fill" style="background-image:url('#');"></div>
            </div>
            <div class="item">
                <!-- http://thumbs.dreamstime.com/x/i-love-rock-16410458.jpg

                http://covermyfb.com/media/covers/10415-i-love-rock.jpg

                http://www.drewnussbaum.com/wp-content/uploads/2014/03/Hendrix-March-2014-blue-face-1.jpg
                -->
                <div class="fill" style="background-image:url('#');"></div>
            </div>
            <div class="item">
                <!-- http://cdn.slashgear.com/wp-content/uploads/2012/07/horrible.jpg
                
                http://images5.fanpop.com/image/photos/29600000/Pop-Music-music-29695347-400-319.jpg

                http://www.karaoke.ie/shop/images/category/pop-music.jpeg

                -->
                <div class="fill" style="background-image:url('#');"></div>
            </div>
            <div class="item">
                <!-- http://img02.deviantart.net/893b/i/2009/235/2/9/i_love_reggae_and_dancehal_by_nizart.png
                
                https://www.wordans.com/wvc-1258088400/wordansfiles/images/2009/10/8/23508/23508_340.jpg
                -->
                <div class="fill" style="background-image:url('#');"></div>
            </div>
            <div class="item">
                <!-- 

                http://hipsterjew.com/files/2011/05/honk-if-you-love-country-music.jpeg
                -->
                <div class="fill" style="background-image:url('#');"></div>
            </div>
        </div>

        <!-- Controls -->
        <a class="left carousel-control" href="#myCarousel" data-slide="prev">
            <span class="icon-prev"></span>
        </a>
        <a class="right carousel-control" href="#myCarousel" data-slide="next">
            <span class="icon-next"></span>
        </a>

    </header>

    <!-- Communication with AJAX -->

    <div id="searchResults" class="container-fluid" style="background-image:url('skulls.png');">
        <div id="content">
                
        </div>
    </div>
    
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script> -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <!-- Script to Activate the Carousel -->
    <script>
    $('.carousel').carousel({
        interval: 5000 //changes the speed
    })
    </script>



    <script type="text/javascript">

        // key authentication begin

            var auth = {
                // Yelp keys and tokens
                consumerKey : "VP4buuF7sj7C57kDOH6sDA",
                consumerSecret : "5U95kCGUarDzJuXWu9jv_R2CUwY",
                accessToken : "eEiiUV5QjwGiCViFaC3u1cJHYgdvuK0d",
                accessTokenSecret : "xw9On4x8N8hePN_GhGJ7_ky98qw",
                serviceProvider : {
                    signatureMethod : "HMAC-SHA1"
                }
            };


            var accessor = {
                consumerSecret : auth.consumerSecret,
                tokenSecret : auth.accessTokenSecret
            };
            parameters = [];
            parameters.push(['callback', 'cb']);
            parameters.push(['oauth_consumer_key', auth.consumerKey]);
            parameters.push(['oauth_consumer_secret', auth.consumerSecret]);
            parameters.push(['oauth_token', auth.accessToken]);
            parameters.push(['oauth_signature_method', 'HMAC-SHA1']);

            // key authentication end

            $('#newSearch').hide();

            $(".btn").on("click", function(e) {
                e.preventDefault()

                var $myMusicInput = $("#musicGenre");
                var $myLocationInput = $("#city");
                var terms = $myMusicInput.val();
                var near = $myLocationInput.val();

                console.log(terms);
                console.log(near);

                parameters.push(['term', terms]);
                parameters.push(['location', near]);

                var message = {
                    'action' : 'http://api.yelp.com/v2/search',
                    'method' : 'GET',
                    'parameters' : parameters

                };

                OAuth.setTimestampAndNonce(message);
                OAuth.SignatureMethod.sign(message, accessor);

                var parameterMap = OAuth.getParameterMap(message.parameters);
                console.log(parameterMap);

                $("body, html").animate({ 
                    scrollTop: $( $(this).attr('href') ).offset().top 
                }, "slow");

                $.ajax({
                    'url' : message.action,
                    'data' : parameterMap,
                    'dataType' : 'jsonp',
                    'jsonpCallback' : 'cb',
                    'cache': true,
                    success : function( data, textStats, XMLHttpRequest ) {
                        console.log( data )
                        var sOptions = "";
                        aBusinesses = data.businesses

                        $.each( aBusinesses, function( index, value ) {
                            aBusinesses = value;

                            sOptions += "<div class='col-md-4'><div class='panel panel-success'><div class='panel-heading'><h4>" + aBusinesses.name + "</h4></div><div class='panel-body'><p>"+ "<div class='thumbnail'><img src="+aBusinesses.image_url+" class='img-rounded' style='width:150px;'></div>" + aBusinesses.location.address[0] + "<br><br> <p class='text-snippet'>" + aBusinesses.snippet_text + "</p> <br> <span class='glyphicon glyphicon-phone-alt' aria-hidden='true'></span>" + aBusinesses.display_phone + "<br><br>" + "<img src="+aBusinesses.rating_img_url_large + "></p><a href='" + aBusinesses.url + "' class='btn btn-default'>Find Out More..</a></div></div></div>"

                        });

                        $("#content").html(sOptions);

                        $('button').hide("");
                        $('#newSearch').show("slow");
                    }
                });
            });

            /* This makes my "GO" button snap to search results

            $(document).ready(function() {
                $(".btn").on("click", function( e ) {

                    e.preventDefault();

                    $("body, html").animate({ 
                        scrollTop: $( $(this).attr('href') ).offset().top 
                    }, 600);

                });
            });*/

            $("#newSearch").on("click", function(e) {
                e.preventDefault()

                $('button').show("");

            });

        </script>

</body>

</html>
